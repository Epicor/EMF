/*
 * emf (Epicor Mobile Framework) 
 * version:1.0.10-dev.141 built: 04-11-2016
*/
if("undefined"==typeof __ep_build_info)var __ep_build_info={};__ep_build_info.chart={libName:"chart",version:"1.0.10-dev.141",built:"2016-11-04"},function(){"use strict";angular.module("ep.chart",["ep.templates","ep.sysconfig"])}(),function(){"use strict";function a(){var a=0;return{next:function(){return a++}}}function b(b,c,d,e){function f(a){return p[a]||o}function g(a){return angular.element(a.state.chartElement).width()}function h(a){var b=angular.element(a.state.chartElement),c=$("body").height()-b.offset().top-25;if(a.settings.parentSelector){var d=$(a.settings.parentSelector),e=d.find(".ep-chart-options").outerHeight(!0),f=d.outerHeight(!0);c=angular.isFunction(a.settings.parentBuffer)?f-e-a.settings.parentBuffer():f-e-(a.settings.parentBuffer?a.settings.parentBuffer:0)}return c}function i(a,b){var c=h(a),d=angular.element(a.state.chartElement);d&&d.length&&d.height(c),b&&a.state.chart&&a.state.chart.resize({height:c}),a.state.chartHeight=c,a.state.chartWidth=d.width()}function j(a){try{k(a)}catch(c){b.error(c),d.hideProgressIndicator()}}function k(a){function b(a){if(0===a.index)return 0;var b=0;angular.forEach(e.data.yValues,function(c){b+=c[a.index+1]});var c=a.value/b*30;return c<2&&(c=2),Math.round(c)}a.menuLegends=void 0,d.showProgressIndicator();var e=a.settings;i(a,!1),c(function(){i(a,!0)});var g=140,h="date"===e.xAxis.type,j=f(e.chartType),k=e.data.yValues&&e.data.yValues.length>1;a.state.chartType=j,a.state.optStackedDisplay=k&&j.stackable,a.state.optDataFmtDisplay="pie"===j.category,a.state.optZoomDisplay="pie"!==j.category&&!j.rotated,a.state.legendSupported=j.legend===!0||k,a.state.optLegendListDisplay=a.state.optLegendDisplay=a.state.legendSupported;var m="pie"===j.category?a.settings.data.xValues.length:a.settings.data.yValues.length;a.state.criteriaHideLegend=m>50||a.state.chartHeight<s,a.state.criteriaHideLegend&&(a.state.optLegend=!1,a.state.optLegendDisplay=!1);var n;!k&&j.color&&(n=function(a,b){return q[b.index%q.length]});var o,p=[];if("pie"===j.category){if(p=e.data.xValues,h){var t=!1;e.data.xValues.length<=1?t=!0:(angular.isDate(e.data.xValues[0][0])||angular.isDate(e.data.xValues[1][0]))&&(t=!0),t&&(p=[],angular.forEach(e.data.xValues,function(a){if(angular.isDate(a[0])){var b=moment(a[0]).format("YYYY, MMMM DD");p.push([b,a[1]])}else p.push(a)}))}}else if("LineAndBarChart"===j.value&&e.data.yValues.length>=2){var u=e.data.yValues[0][0];o={},o[u]="line",p.push(e.data.yValues[0]),p.push(e.data.yValues[1])}else angular.forEach(e.data.yValues,function(a){p.push(a)});var v;if(h)g=80,v="%Y-%m-%d","year"===e.dateUnit?v="%Y":"month"===e.dateUnit&&(v="%Y-%m");else{if("pie"!==j.category){var w=_.find(e.data.xValues,function(a){return(a?a.length:0)>15});w||(g=100),a.state.chartHeight<200&&(g=80)}v=function(b){var c=a.state.chartHeight<200?10:20,d=e.data.xValues[b+1];return d&&d.length>c&&(d=d.substring(0,c)+"..."),d}}var x,y=h&&"pie"!==j.category?"timeseries":"category";"timeseries"===y&&(p.push(e.data.xValues),x=e.data.xValues[0]);var z;"BubbleChart"===j.value&&(z={r:k?b:15});var A={bindto:a.state.chartElement[0],data:{x:x,columns:p,type:j.ctype,types:o,color:n},point:z,axis:{rotated:j.rotated===!0,x:{type:y,tick:{rotate:75,multiline:!1,format:v},height:g,label:{text:e.xAxis.label,position:j.rotated!==!0?"outer-center":"outer-middle"}},y:{label:{text:e.yAxis.label,position:j.rotated!==!0?"outer-middle":"outer-center"}}},bar:{width:{ratio:.8}},pie:{label:{format:function(b,c){return"percent"===a.state.optDataFmt?(100*c).toFixed(2)+"%":b}}},donut:{label:{format:function(b,c){return"percent"===a.state.optDataFmt?(100*c).toFixed(2)+"%":b}}},grid:{x:{show:!1},y:{show:!0}},legend:{show:a.state.legendSupported&&a.state.optLegend},zoom:{enabled:a.state.optZoomDisplay&&a.state.optZoom},subchart:{show:a.state.optZoomDisplay&&a.state.optZoom&&a.state.chartHeight>r},onrendered:function(){l(a)}};a.state.chart=c3.generate(A)}function l(a){c(function(){a.state.whenRendered=new Date,d.hideProgressIndicator()})}function m(a,b){a.state={theElement:b,chartElement:angular.element(b).find("#chartc3"),$chartElement:angular.element(angular.element(b).find("#chartc3")),chart:null,chartId:n.next(),chartHeight:-1,selectAllLegend:!0,optStacked:"grouped",optStackedDisplay:!1,optLegendListDisplay:!1,optLegendDisplay:!1,optLegend:!0,optDataFmtDisplay:!1,optDataFmt:"percent",optZoomDisplay:!1,optZoom:!1},a.$watch("settings",function(b){b&&(a.optZoom=!1,j(a))}),a.fnOptStackedChanged=function(){var b=[];"stacked"===a.state.optStacked&&angular.forEach(a.state.chart.data(),function(a){b.push(a.id)}),a.state.chart.groups([b])},a.fnOptLegendChanged=function(b){a.state.optLegend=!a.state.optLegend,d.showProgressIndicator(),a.state.optLegend?a.state.chart.legend.show():a.state.chart.legend.hide(),b||(a.state.previousOptLegend=!1)},a.fnOnLegendList=function(){if(void 0===a.menuLegends){a.menuLegends=[];var b=[],c=a.state.chart.data.colors();angular.forEach(a.state.chart.data(),function(a){b.push({id:a.id,caption:a.id,checked:!0,color:c[a.id]+"",style:{backgroundColor:c[a.id].toString()}})}),a.menuLegends=b,a.updateMenuLegendState()}else a.state.whenRendered>a.state.whenMenuLegendState&&a.updateMenuLegendState()},a.fnOnLegendChanged=function(b){b.checked=!b.checked,a.state.chart.toggle(b.id)},a.fnLegendSelectAllChanged=function(){var b=[];angular.forEach(a.menuLegends,function(c){b.push(c.id),c.checked=a.state.selectAllLegend}),a.state.selectAllLegend?a.state.chart.show(b):a.state.chart.hide(b)},a.updateMenuLegendState=function(){a.menuLegends&&(angular.forEach(a.menuLegends,function(b){b.checked=a.state.chart.internal.isTargetToShow(b.id)}),a.state.whenMenuLegendState=new Date)},a.fnOptDataFmtChanged=function(){a.state.chart.show()},a.fnOptZoomChanged=function(){a.state.chart.destroy(),j(a),a.state.optZoomTip=a.state.chartHeight>r,a.state.optZoomTip&&c(function(){a.state.optZoomTip=!1},7e3)},a.checkShowLegendOption=function(){if(a.state.legendSupported){var b="pie"===a.state.chartType.category?a.settings.data.xValues.length:a.settings.data.yValues.length;a.state.criteriaHideLegend=b>50||a.state.chartHeight<s,a.state.criteriaHideLegend?(a.state.optLegendDisplay=!1,a.state.optLegend&&(a.state.previousOptLegend=!0,a.fnOptLegendChanged(!0))):(a.state.optLegendDisplay=!0,!a.state.optLegend&&a.state.previousOptLegend&&a.fnOptLegendChanged(!0),a.state.previousOptLegend=!1)}},d.registerViewEvent("ep-resize-chart"+a.state.chartId,e.SHELL_SIZE_CHANGE_EVENT,function(){a.state.$chartElement.is(":visible")&&(c.cancel(a.state.timeoutResize),a.state.timeoutResize=c(function(){var b=!1,c=g(a);Math.abs(c-a.state.chartWidth)>20&&(a.state.chartWidth=c,b=!0);var d=h(a);Math.abs(d-a.state.chartHeight)>20&&(b=!0),b&&a.checkShowLegendOption(),i(a,!0)},250))})}var n=a(),o={ctype:"bar"},p={LineChart:_.extend(_.clone(o),{name:"Line",value:"LineChart",ctype:"line"}),SplineChart:_.extend(_.clone(o),{name:"Spline",value:"SplineChart",ctype:"spline"}),ScatterChart:_.extend(_.clone(o),{name:"Scatter",value:"ScatterChart",ctype:"scatter"}),BubbleChart:_.extend(_.clone(o),{name:"Bubble",value:"BubbleChart",ctype:"scatter",point:!0,color:!0}),StackedAreaChart:_.extend(_.clone(o),{name:"Stacked Area",value:"StackedAreaChart",ctype:"area-spline",isStacked:!0,isArea:!0,stackable:!0}),ColumnChart:_.extend(_.clone(o),{name:"Column",value:"ColumnChart",ctype:"bar",color:!0,stackable:!0}),HorizontalBarChart:_.extend(_.clone(o),{name:"Horizontal Bar",value:"HorizontalBarChart",ctype:"bar",rotated:!0,color:!0,stackable:!0}),LineAndBarChart:_.extend(_.clone(o),{name:"Line and Bar",value:"LineAndBarChart",ctype:"bar"}),PieChart:_.extend(_.clone(o),{name:"Pie",value:"PieChart",ctype:"pie",legend:!0,category:"pie"}),DoughnutChart:_.extend(_.clone(o),{name:"Doughnut",value:"DoughnutChart",ctype:"donut",legend:!0,category:"pie"})},q=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],r=400,s=350;return{restrict:"E",replace:!0,templateUrl:"src/components/ep.chart/ep-chart-c3.html",scope:{settings:"="},compile:function(){return{pre:angular.noop,post:m}}}}b.$inject=["$log","$timeout","epShellService","epShellConstants"],angular.module("ep.chart").directive("epChartC3",b)}(),angular.module("ep.templates").run(["$templateCache",function(a){"use strict";a.put("src/components/ep.chart/ep-chart-c3-legends.html",'<div class="ep-chart-c3-legends form-group"><span><label class=checkbox-inline><input type=checkbox ng-model=state.selectAllLegend ng-change=fnLegendSelectAllChanged()>All</label></span><div ng-repeat="item in menuLegends"><button type=button class="btn btn-sm btn-block" ng-class="{\'ep-legend-off\': item.checked !== true}" ng-style=item.style ng-model=item.checked uib-btn-checkbox ng-click=fnOnLegendChanged(item)>{{item.caption}}</button></div></div>'),a.put("src/components/ep.chart/ep-chart-c3.html",'<div class=ep-chart-c3><div class="ep-chart-options form-group"><div class=checkbox><div ng-if=state.optLegendListDisplay class="ep-c3-legend-btn btn-group" dropdown><button id=split-button type=button class="btn btn-default btn-sm" popover-template="\'src/components/ep.chart/ep-chart-c3-legends.html\'" popover-placement=bottom-left popover-title=Legend popover-trigger="" ng-click=fnOnLegendList()>Legend</button></div><span ng-if=state.optStackedDisplay><label class=radio-inline><input name=optradio type=radio value=grouped ng-model=state.optStacked ng-change=fnOptStackedChanged()>Grouped</label><label class=radio-inline><input name=optradio type=radio value=stacked ng-model=state.optStacked ng-change=fnOptStackedChanged()>Stacked</label></span> <span ng-if=state.optDataFmtDisplay><label class=radio-inline><input name=optradio type=radio value=percent ng-model=state.optDataFmt ng-change=fnOptDataFmtChanged()>Percent</label><label class=radio-inline><input name=optradio type=radio value=value ng-model=state.optDataFmt ng-change=fnOptDataFmtChanged()>Value</label></span> <span ng-if=state.optZoomDisplay style="margin-left: 10px"><label class=checkbox-inline><input type=checkbox ng-model=state.optZoom ng-change=fnOptZoomChanged()>Zoom</label></span> <span ng-if="state.optZoomDisplay && state.optZoom && state.optZoomTip" ng-click="state.optZoomTip = false" class="well ep-fadein-animation" style="margin-left: 10px">to zoom-in select an area on the lower chart; to zoom-out double click on the lower chart.</span> <span ng-if=state.optLegendDisplay style="margin-left: 5px" class=ep-opt-legend><label class=checkbox-inline><a ng-click=fnOptLegendChanged()>{{state.optLegend ? \'Hide legend\' : \'Show legend\' }}</a></label></span> <span ng-if="!state.optLegendDisplay && state.criteriaHideLegend" class=ep-opt-legend-hidden><label class=checkbox-inline>[legend hidden]</label></span></div></div><div style=background-color:white;height:100%><div id=chartc3 style="min-height:80px; width: 100%"></div></div></div>')}]);
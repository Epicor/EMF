/*
 * emf (Epicor Mobile Framework) 
 * version:1.0.20-dev.1 built: 11-10-2017
*/
if("undefined"==typeof __ep_build_info)var __ep_build_info={};__ep_build_info.chart={libName:"chart",version:"1.0.20-dev.1",built:"2017-10-11"},function(){"use strict";angular.module("ep.chart",["ep.templates","ep.sysconfig"])}(),function(){"use strict";function a(a,b,c,d,e,f){function g(a){return q[a]||p}function h(a){return angular.element(a.state.chartElement).width()}function i(a){var b=angular.element(a.state.theElement),c=$(window).height()-b.offset().top,d=a.settings.height;if("view"===d||void 0===d){var e=angular.element("#viewContainer");e.length&&(c=e.height()-b.offset().top)}else if(angular.isNumber(d))c=d;else if(angular.isFunction(d))c=d();else if(angular.isString(d)||d instanceof HTMLElement){var f=$(d);f.length&&(c=f.outerHeight(!0))}var g=a.settings.showOptions!==!1?-25:30;return g=angular.isFunction(a.settings.heightOffset)?a.settings.heightOffset(c):a.settings.heightOffset?a.settings.heightOffset:g,c+=g}function j(a,b){var d=i(a),e=angular.element(a.state.chartElement);e&&e.length&&e.height(d),b&&a.state.chart&&(a.state.chart.resize({height:d}),c.$emit(f.CHART_HAS_RESIZED_EVENT,{settings:a.settings,id:a.state.chartId})),a.state.chartHeight=d,a.state.chartWidth=e.width()}function k(c){var e=function(){$(c.state.theElement).is(":visible")?l(c):b(function(){e(c)},200)};try{e()}catch(f){a.error(f),d.hideProgressIndicator()}}function l(a){function b(a){if(0===a.index)return 0;var b=0;angular.forEach(c.data.yValues,function(c){b+=c[a.index+1]});var d=a.value/b*30;return d<2&&(d=2),Math.round(d)}a.menuLegends=void 0,d.showProgressIndicator();var c=a.settings;j(a,!1);var e=140,f="date"===c.xAxis.type,h=g(c.chartType),i=c.data.yValues&&c.data.yValues.length>1;a.state.chartType=h,a.state.optStackedDisplay=c.stacked!==!1&&i&&h.stackable,a.state.optDataFmtDisplay="pie"===h.category,a.state.optZoomDisplay=c.zoom!==!1&&"pie"!==h.category&&!h.rotated,a.state.legendSupported=c.legend!==!1&&(h.legend===!0||i),a.state.optLegendListDisplay=a.state.optLegendDisplay=a.state.legendSupported;var k="pie"===h.category?a.settings.data.xValues.length:a.settings.data.yValues.length;a.state.criteriaHideLegend=a.settings.autoHideLegends!==!1&&(k>50||a.state.chartHeight<t),a.state.criteriaHideLegend&&(a.state.optLegend=!1,a.state.optLegendDisplay=!1);var l;!i&&h.color&&(l=function(a,b){return r[b.index%r.length]});var n,o=[];if("pie"===h.category){if(o=c.data.xValues,f){var p=!1;c.data.xValues.length<=1?p=!0:(angular.isDate(c.data.xValues[0][0])||angular.isDate(c.data.xValues[1][0]))&&(p=!0),p&&(o=[],angular.forEach(c.data.xValues,function(a){if(angular.isDate(a[0])){var b=moment(a[0]).format("YYYY, MMMM DD");o.push([b,a[1]])}else o.push(a)}))}}else if("LineAndBarChart"===h.value&&c.data.yValues.length>=2){var q=c.data.yValues[0][0];n={},n[q]="line",o.push(c.data.yValues[0]),o.push(c.data.yValues[1])}else angular.forEach(c.data.yValues,function(a){o.push(a)});var u;if(f)e=80,u="%Y-%m-%d","year"===c.dateUnit?u="%Y":"month"===c.dateUnit&&(u="%Y-%m");else{if("pie"!==h.category){var v=_.find(c.data.xValues,function(a){return(a?a.length:0)>15});v||(e=100),a.state.chartHeight<200&&(e=80)}u=function(b){var d=a.state.chartHeight<200?10:20,e=c.data.xValues[b+1];return e&&e.length>d&&(e=e.substring(0,d)+"..."),e}}var w,x=f&&"pie"!==h.category?"timeseries":"category";"timeseries"===x&&(o.push(c.data.xValues),w=c.data.xValues[0]);var y;"BubbleChart"===h.value&&(y={r:i?b:15});var z={bindto:a.state.chartElement[0],data:{x:w,columns:o,type:h.ctype,types:n,color:l},point:y,axis:{rotated:h.rotated===!0,x:{type:x,tick:{rotate:75,multiline:!1,format:u},height:e,label:{text:c.xAxis.label,position:h.rotated!==!0?"outer-center":"outer-middle"}},y:{label:{text:c.yAxis.label,position:h.rotated!==!0?"outer-middle":"outer-center"}}},bar:{width:{ratio:.8}},pie:{label:{format:function(b,c){return"percent"===a.state.optDataFmt?(100*c).toFixed(2)+"%":b}}},donut:{label:{format:function(b,c){return"percent"===a.state.optDataFmt?(100*c).toFixed(2)+"%":b}}},grid:{x:{show:!1},y:{show:!0}},legend:{show:a.state.legendSupported&&a.state.optLegend},zoom:{enabled:a.state.optZoomDisplay&&a.state.optZoom},subchart:{show:a.state.optZoomDisplay&&a.state.optZoom&&a.state.chartHeight>s},onrendered:function(){m(a)}};a.state.chart=c3.generate(z)}function m(a){b(function(){a.state.whenRendered=new Date,d.hideProgressIndicator()})}function n(a){a.state.$chartElement.is(":visible")&&(b.cancel(a.state.timeoutResize),a.state.timeoutResize=b(function(){var b=!1,c=h(a);Math.abs(c-a.state.chartWidth)>20&&(a.state.chartWidth=c,b=!0);var d=i(a);Math.abs(d-a.state.chartHeight)>20&&(b=!0),b&&a.checkShowLegendOption(),j(a,!0)},250))}function o(a,g){a.state={theElement:g,chartElement:angular.element(g).find("#chartc3"),$chartElement:angular.element(angular.element(g).find("#chartc3")),chart:null,chartId:a.settings.id||a.$id,chartHeight:-1,selectAllLegend:!0,optStacked:"grouped",optStackedDisplay:!1,optLegendListDisplay:!1,optLegendDisplay:!1,optLegend:!0,optDataFmtDisplay:!1,optDataFmt:"percent",optZoomDisplay:!1,optZoom:!1},a.$watch("settings",function(b){b&&(a.optZoom=!1,k(a))}),a.fnOptStackedChanged=function(){var b=[];"stacked"===a.state.optStacked&&angular.forEach(a.state.chart.data(),function(a){b.push(a.id)}),a.state.chart.groups([b])},a.fnOptLegendChanged=function(b){a.state.optLegend=!a.state.optLegend,d.showProgressIndicator(),a.state.optLegend?a.state.chart.legend.show():a.state.chart.legend.hide(),b||(a.state.previousOptLegend=!1)},a.fnOnLegendList=function(){if(void 0===a.menuLegends){a.menuLegends=[];var b=[],c=a.state.chart.data.colors();angular.forEach(a.state.chart.data(),function(a){b.push({id:a.id,caption:a.id,checked:!0,color:c[a.id]+"",style:{backgroundColor:c[a.id].toString()}})}),a.menuLegends=b,a.updateMenuLegendState()}else a.state.whenRendered>a.state.whenMenuLegendState&&a.updateMenuLegendState()},a.fnOnLegendChanged=function(b){b.checked=!b.checked,a.state.chart.toggle(b.id)},a.fnLegendSelectAllChanged=function(){var b=[];angular.forEach(a.menuLegends,function(c){b.push(c.id),c.checked=a.state.selectAllLegend}),a.state.selectAllLegend?a.state.chart.show(b):a.state.chart.hide(b)},a.updateMenuLegendState=function(){a.menuLegends&&(angular.forEach(a.menuLegends,function(b){b.checked=a.state.chart.internal.isTargetToShow(b.id)}),a.state.whenMenuLegendState=new Date)},a.fnOptDataFmtChanged=function(){a.state.chart.show()},a.fnOptZoomChanged=function(){a.state.chart.destroy(),k(a),a.state.optZoomTip=a.state.chartHeight>s,a.state.optZoomTip&&b(function(){a.state.optZoomTip=!1},7e3)},a.checkShowLegendOption=function(){if(a.state.legendSupported&&a.settings.autoHideLegends!==!1){var b="pie"===a.state.chartType.category?a.settings.data.xValues.length:a.settings.data.yValues.length;a.state.criteriaHideLegend=b>50||a.state.chartHeight<t,a.state.criteriaHideLegend?(a.state.optLegendDisplay=!1,a.state.optLegend&&(a.state.previousOptLegend=!0,a.fnOptLegendChanged(!0))):(a.state.optLegendDisplay=!0,!a.state.optLegend&&a.state.previousOptLegend&&a.fnOptLegendChanged(!0),a.state.previousOptLegend=!1)}},d.registerViewEvent("ep-resize-chart"+a.$id,e.SHELL_SIZE_CHANGE_EVENT,function(){n(a)}),c.$on(f.CHART_RESIZE_EVENT,function(b){!angular.isString(b)||b&&b!==a.state.chartId||n(a)})}var p={ctype:"bar"},q={LineChart:_.extend(_.clone(p),{name:"Line",value:"LineChart",ctype:"line"}),SplineChart:_.extend(_.clone(p),{name:"Spline",value:"SplineChart",ctype:"spline"}),ScatterChart:_.extend(_.clone(p),{name:"Scatter",value:"ScatterChart",ctype:"scatter"}),BubbleChart:_.extend(_.clone(p),{name:"Bubble",value:"BubbleChart",ctype:"scatter",point:!0,color:!0}),StackedAreaChart:_.extend(_.clone(p),{name:"Stacked Area",value:"StackedAreaChart",ctype:"area-spline",isStacked:!0,isArea:!0,stackable:!0}),ColumnChart:_.extend(_.clone(p),{name:"Column",value:"ColumnChart",ctype:"bar",color:!0,stackable:!0}),HorizontalBarChart:_.extend(_.clone(p),{name:"Horizontal Bar",value:"HorizontalBarChart",ctype:"bar",rotated:!0,color:!0,stackable:!0}),LineAndBarChart:_.extend(_.clone(p),{name:"Line and Bar",value:"LineAndBarChart",ctype:"bar"}),PieChart:_.extend(_.clone(p),{name:"Pie",value:"PieChart",ctype:"pie",legend:!0,category:"pie"}),DoughnutChart:_.extend(_.clone(p),{name:"Doughnut",value:"DoughnutChart",ctype:"donut",legend:!0,category:"pie"})},r=["#1f77b4","#aec7e8","#ff7f0e","#ffbb78","#2ca02c","#98df8a","#d62728","#ff9896","#9467bd","#c5b0d5","#8c564b","#c49c94","#e377c2","#f7b6d2","#7f7f7f","#c7c7c7","#bcbd22","#dbdb8d","#17becf","#9edae5"],s=400,t=350;return{restrict:"E",replace:!0,templateUrl:"src/components/ep.chart/ep-chart-c3.html",scope:{settings:"="},compile:function(){return{pre:angular.noop,post:o}}}}a.$inject=["$log","$timeout","$rootScope","epShellService","epShellConstants","epChartConstants"],angular.module("ep.chart").directive("epChartC3",a)}(),function(){"use strict";angular.module("ep.chart").constant("epChartConstants",{CHART_RESIZE_EVENT:"EP_CHART_RESIZE_EVENT",CHART_HAS_RESIZED_EVENT:"EP_CHART_HAS_RESIZED_EVENT"})}(),angular.module("ep.templates").run(["$templateCache",function(a){"use strict";a.put("src/components/ep.chart/ep-chart-c3-legends.html",'<div class="ep-chart-c3-legends form-group"><span><label class=checkbox-inline><input type=checkbox ng-model=state.selectAllLegend ng-change=fnLegendSelectAllChanged()>All</label></span><div ng-repeat="item in menuLegends"><button type=button class="btn btn-sm btn-block" ng-class="{\'ep-legend-off\': item.checked !== true}" ng-style=item.style ng-model=item.checked uib-btn-checkbox ng-click=fnOnLegendChanged(item)>{{item.caption}}</button></div></div>'),a.put("src/components/ep.chart/ep-chart-c3.html",'<div class=ep-chart-c3 ep-chart-id=state.chartId><div class="ep-chart-options form-group" ng-if="settings.showOptions !== false"><div class=checkbox><div ng-if=state.optLegendListDisplay class="ep-c3-legend-btn btn-group" dropdown><button id=split-button type=button class="btn btn-default btn-sm" uib-popover-template="\'src/components/ep.chart/ep-chart-c3-legends.html\'" popover-placement=bottom-left popover-title=Legend popover-trigger="" ng-click=fnOnLegendList()>Legend</button></div><span ng-if=state.optStackedDisplay><label class=radio-inline><input name=optradio type=radio value=grouped ng-model=state.optStacked ng-change=fnOptStackedChanged()>Grouped</label><label class=radio-inline><input name=optradio type=radio value=stacked ng-model=state.optStacked ng-change=fnOptStackedChanged()>Stacked</label></span> <span ng-if=state.optDataFmtDisplay><label class=radio-inline><input name=optradio type=radio value=percent ng-model=state.optDataFmt ng-change=fnOptDataFmtChanged()>Percent</label><label class=radio-inline><input name=optradio type=radio value=value ng-model=state.optDataFmt ng-change=fnOptDataFmtChanged()>Value</label></span> <span ng-if=state.optZoomDisplay style="margin-left: 10px"><label class=checkbox-inline><input type=checkbox ng-model=state.optZoom ng-change=fnOptZoomChanged()>Zoom</label></span> <span ng-if="state.optZoomDisplay && state.optZoom && state.optZoomTip" ng-click="state.optZoomTip = false" class="well ep-fadein-animation" style="margin-left: 10px">to zoom-in select an area on the lower chart; to zoom-out double click on the lower chart.</span> <span ng-if=state.optLegendDisplay style="margin-left: 5px" class=ep-opt-legend><label class=checkbox-inline><a ng-click=fnOptLegendChanged()>{{state.optLegend ? \'Hide legend\' : \'Show legend\' }}</a></label></span> <span ng-if="!state.optLegendDisplay && state.criteriaHideLegend && state.legendSupported && settings.legendHiddenText !== \'\'" class=ep-opt-legend-hidden><label class=checkbox-inline>{{settings.legendHiddenText || \'[legend hidden]\'}}</label></span></div></div><div class=ep-chart-div><div id=chartc3></div></div></div>')}]);